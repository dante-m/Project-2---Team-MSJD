<!DOCTYPE html>
<html lang="en">

<head>
	<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>

<body>
	<script src="https://d3js.org/d3.v5.min.js"></script>
	<div id="myDiv" style="width: auto; height: 400px;">

	</div>
	<script>
		function makeplot() {
			Plotly.d3.csv("teams.csv", function (err, data) { processData(data) });
		};

		function processData(allRows) {

			console.log('all rowsssss', allRows);
			//var x = [], y = [], y2 = [], teams = [], standard_deviation = [];

			/*
			const allTeams = {
				't1': [{date: '2000', attend: '', wins: ''}, {date: '2001', attend: '', wins: ''}],
				't2': [{date: '2000', attend: '', wins: ''}, {date: '2001', attend: '', wins: ''}]
			};	
			*/
			const allTeams = {};		

			for (var i = 0; i < allRows.length; i++) {
				row = allRows[i];
				if (allTeams[row['team']]) {
					allTeams[row['team']].push({
						date: row['date'],
						wins: row['wins'],
						attend: row['attend']
					})
				} else {
					allTeams[row['team']] = [{
						date: row['date'],
						wins: row['wins'],
						attend: row['attend']
					}]
				}
				
				

/*
				x.push(row['date']);
				y.push(row['wins']);
				y2.push(row['attend']);
				if (!teams.includes(row['team'])) teams.push(row['team']);*/
			}
			const teams = Object.keys(allTeams);
			const visibles = new Array(teams.length).fill(false);
			console.log('uuuu====>>>>', visibles)
			const buttons = teams.map((team, index) => {
				const newVisibles = visibles.map((v, i) => {
					if (i == index) {
						return true;
					}
					return false;
				});
				return {
					method: 'restyle',
					args: ['visible', visibles],
					label: team
				}
			});
			console.log('buuuuuu====>>>>', buttons)
			//makePlotly(x, y, y2, teams, standard_deviation);
		}

		function makePlotly(x, y, y2, teams, standard_deviation) {
			var plotDiv = document.getElementById("plot");
			var traces = [{
				x: x,
				y: y
			}, {
				x: x,
				y: y2,
				yaxis: 'y2'
			}];



			Plotly.newPlot('myDiv', traces,
				{
					title: 'Comparing MLB Wins To Attendance',
					updatemenus: [{
						y: 1,
						yanchor: 'top',
						buttons: buttons
					}],
					yaxis: { title: 'wins' },
					yaxis2: {
						title: 'attendance',
						overlaying: 'y',
						side: 'right'
					}
				});
		};
		makeplot();
	</script>
</body>

</html>